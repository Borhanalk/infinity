generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Category {
  id        Int      @id @default(autoincrement())
  name      String
  imageUrl  String?
  createdAt DateTime @default(now())

  products Product[] // ğŸ‘ˆ Ø¹Ù„Ø§Ù‚Ø© Ø¹ÙƒØ³ÙŠØ©
}

model Company {
  id        Int      @id @default(autoincrement())
  name      String   @unique
  logoUrl   String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  products Product[] // ğŸ‘ˆ Ø¹Ù„Ø§Ù‚Ø© Ø¹ÙƒØ³ÙŠØ©

  @@index([name])
}

model Product {
  id          String @id @default(uuid())
  name        String @default("") // Ø§Ø³Ù… Ø§Ø®ØªÙŠØ§Ø±ÙŠ (ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† ÙØ§Ø±ØºØ§Ù‹)
  price       Float
  description String @default("") // ÙˆØµÙ Ø§Ø®ØªÙŠØ§Ø±ÙŠ

  categoryId Int // âœ… Ù†ÙØ³ Ù†ÙˆØ¹ Category.id
  category   Category @relation(fields: [categoryId], references: [id])

  companyId Int // âœ… Ù…Ø¹Ø±Ù Ø§Ù„Ø´Ø±ÙƒØ© (Ù…Ø·Ù„ÙˆØ¨)
  company   Company @relation(fields: [companyId], references: [id])

  createdAt DateTime @default(now())

  // New fields for collections and sales
  isNew           Boolean @default(false)
  isOnSale        Boolean @default(false)
  discountPercent Int? // 0-100
  discountAmount  Float? // Ù…Ø¨Ù„Øº Ø§Ù„ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ø«Ø§Ø¨Øª
  originalPrice   Float? // Original price before discount

  images     ProductImage[]
  colors     ProductColor[]
  sizes      ProductSize[]
  newArrival NewArrival? // Ø¹Ù„Ø§Ù‚Ø© Ù…Ø¹ Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
}

model ProductImage {
  id        String  @id @default(uuid())
  url       String
  productId String
  product   Product @relation(fields: [productId], references: [id])
}

model ProductColor {
  id        String  @id @default(uuid())
  name      String
  hex       String
  productId String
  product   Product @relation(fields: [productId], references: [id])
}

model ProductSize {
  id        String  @id @default(uuid())
  size      String
  quantity  Int
  productId String
  product   Product @relation(fields: [productId], references: [id])
}

model Campaign {
  id              String    @id @default(uuid())
  title           String
  description     String?
  discountPercent Int? // Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ… (0-100)
  discountAmount  Float? // Ù…Ø¨Ù„Øº Ø§Ù„Ø®ØµÙ… Ø§Ù„Ø«Ø§Ø¨Øª
  isActive        Boolean   @default(true)
  showOnHomepage  Boolean   @default(false) // Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
  startDate       DateTime?
  endDate         DateTime?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt

  products CampaignProduct[]
}

model CampaignProduct {
  id         String   @id @default(uuid())
  campaignId String
  productId  String
  campaign   Campaign @relation(fields: [campaignId], references: [id], onDelete: Cascade)

  @@unique([campaignId, productId])
  @@index([productId])
}

model Admin {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String // Hashed password using bcrypt
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([email])
}

model NewArrival {
  id        String   @id @default(uuid())
  productId String   @unique
  product   Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  order     Int      @default(0) // ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ø±Ø¶
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([productId])
  @@index([order])
}
